{
  "version": "2.0.0",
  "tasks": [
    // ==================== MARKETPLACE DEV (NEW) ====================
    {
      "label": "ðŸ›ï¸ Marketplace: Dev Mode",
      "dependsOn": ["ðŸ”¥ Firebase Emulators", "ðŸ“¦ Customer App (Port 5173)"],
      "problemMatcher": [],
      "group": {
        "kind": "build",
        "isDefault": false
      },
      "presentation": {
        "reveal": "always",
        "panel": "shared"
      }
    },
    {
      "label": "ðŸ”¥ Firebase Emulators",
      "type": "shell",
      "command": "./scripts/start-emulators.sh",
      "isBackground": true,
      "problemMatcher": {
        "pattern": {
          "regexp": "^.*$",
          "file": 1,
          "location": 2,
          "message": 3
        },
        "background": {
          "activeOnStart": true,
          "beginsPattern": ".*Starting.*Emulators.*",
          "endsPattern": ".*Ready.*View Emulator.*"
        }
      },
      "presentation": {
        "reveal": "always",
        "panel": "dedicated",
        "clear": false,
        "echo": true,
        "focus": false
      }
    },
    
    // ==================== DEV SERVERS (Run These) ====================
    {
      "label": "ðŸ”§ Admin App (Port 3000)",
      "type": "shell",
      "command": "pnpm --filter @gosenderr/admin-app dev",
      "isBackground": true,
      "problemMatcher": {
        "pattern": {
          "regexp": "^([^\\s].*):(\\d+):(\\d+):\\s+(warning|error):\\s+(.*)$",
          "file": 1,
          "line": 2,
          "column": 3,
          "severity": 4,
          "message": 5
        },
        "background": {
          "activeOnStart": true,
          "beginsPattern": "^.*VITE.*$",
          "endsPattern": "^.*ready in.*$"
        }
      },
      "presentation": {
        "reveal": "always",
        "panel": "dedicated",
        "focus": false,
        "clear": true
      },
      "group": {
        "kind": "build",
        "isDefault": true
      }
    },

    {
      "label": "ðŸ“¦ Customer App (Port 5173)",
      "type": "shell",
      "command": "pnpm --filter @gosenderr/marketplace-app dev",
      "isBackground": true,
      "problemMatcher": {
        "pattern": {
          "regexp": "^([^\\s].*):(\\d+):(\\d+):\\s+(warning|error):\\s+(.*)$",
          "file": 1,
          "line": 2,
          "column": 3,
          "severity": 4,
          "message": 5
        },
        "background": {
          "activeOnStart": true,
          "beginsPattern": "^.*VITE.*$",
          "endsPattern": "^.*ready in.*$"
        }
      },
      "presentation": {
        "reveal": "always",
        "panel": "dedicated",
        "focus": false,
        "clear": true
      }
    },
    {
      "label": "ðŸ“¦ Customer App (Port 5180)",
      "type": "shell",
      "command": "PORT=5180 VITE_PORT=5180 pnpm --filter @gosenderr/marketplace-app dev -- --host 127.0.0.1",
      "isBackground": true,
      "problemMatcher": {
        "pattern": {
          "regexp": "^([^\\s].*):(\\d+):(\\d+):\\s+(warning|error):\\s+(.*)$",
          "file": 1,
          "line": 2,
          "column": 3,
          "severity": 4,
          "message": 5
        },
        "background": {
          "activeOnStart": true,
          "beginsPattern": "^.*VITE.*$",
          "endsPattern": "^.*ready in.*$"
        }
      },
      "presentation": {
        "reveal": "always",
        "panel": "dedicated",
        "focus": false,
        "clear": true
      }
    },
    {
      "label": "âš¡ Courier App (Port 5174)",
      "type": "shell",
      "command": "pnpm --filter @gosenderr/courier-app dev",
      "isBackground": true,
      "problemMatcher": {
        "pattern": {
          "regexp": "^([^\\s].*):(\\d+):(\\d+):\\s+(warning|error):\\s+(.*)$",
          "file": 1,
          "line": 2,
          "column": 3,
          "severity": 4,
          "message": 5
        },
        "background": {
          "activeOnStart": true,
          "beginsPattern": "^.*VITE.*$",
          "endsPattern": "^.*ready in.*$"
        }
      },
      "presentation": {
        "reveal": "always",
        "panel": "dedicated",
        "focus": false,
        "clear": true
      }
    },
    {
      "label": "ï¿½ï¸ Admin Desktop: Vite Dev Server (Port 5176)",
      "type": "shell",
      "command": "pnpm --filter @gosenderr/admin-desktop dev",
      "isBackground": true,
      "problemMatcher": {
        "pattern": {
          "regexp": "^([^\\s].*):(\\d+):(\\d+):\\s+(warning|error):\\s+(.*)$",
          "file": 1,
          "line": 2,
          "column": 3,
          "severity": 4,
          "message": 5
        },
        "background": {
          "activeOnStart": true,
          "beginsPattern": "^.*VITE.*$",
          "endsPattern": "^.*ready in.*$"
        }
      },
      "presentation": {
        "reveal": "always",
        "panel": "dedicated",
        "focus": false,
        "clear": true
      }
    },
    {
      "label": "ðŸ–¥ï¸ Admin Desktop: Electron App",
      "type": "shell",
      "command": "sleep 3 && cd apps/admin-desktop && pnpm electron",
      "isBackground": true,
      "dependsOn": ["ðŸ–¥ï¸ Admin Desktop: Vite Dev Server (Port 5176)"],
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "dedicated",
        "focus": true,
        "clear": false
      }
    },
    {
      "label": "ðŸŒ Web/Marketing App (Port 3003)",
      "type": "shell",
      "command": "pnpm --filter @gosenderr/web dev",
      "isBackground": true,
      "problemMatcher": {
        "pattern": {
          "regexp": "^([^\\s].*):(\\d+):(\\d+)\\s+-\\s+(warning|error)\\s+(.*)$",
          "file": 1,
          "line": 2,
          "column": 3,
          "severity": 4,
          "message": 5
        },
        "background": {
          "activeOnStart": true,
          "beginsPattern": "^.*starting.*$",
          "endsPattern": "^.*Local:.*$"
        }
      },
      "presentation": {
        "reveal": "always",
        "panel": "dedicated",
        "focus": false
      }
    },
    {
      "label": "ðŸš€ All Vite Apps",
      "dependsOn": [
        "ðŸ”§ Admin App (Port 3000)",
        "ðŸ“¦ Customer App (Port 5173)",
        "âš¡ Courier App (Port 5174)"
      ],
      "problemMatcher": []
    },
    {
      "label": "ðŸŽ¯ Phase 1: Admin Desktop Dev",
      "dependsOn": [
        "ðŸ”¥ Firebase Emulators",
        "ðŸ–¥ï¸ Admin Desktop: Vite Dev Server (Port 5176)",
        "ðŸ–¥ï¸ Admin Desktop: Electron App"
      ],
      "problemMatcher": [],
      "group": {
        "kind": "build",
        "isDefault": false
      },
      "presentation": {
        "reveal": "always",
        "panel": "shared"
      }
    },
    {
      "label": "ðŸŒ All Apps (All Ports)",
      "type": "shell",
      "command": "pnpm dev",
      "isBackground": true,
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "dedicated",
        "focus": false
      }
    },
    {
      "label": "Run Admin App Tests",
      "type": "shell",
      "command": "pnpm --prefix apps/admin-app run test -- --run --reporter verbose",
      "group": "test",
      "presentation": {
        "reveal": "silent"
      },
      "problemMatcher": []
    },

    // ==================== STOP TASKS ====================
    {
      "label": "ðŸ›‘ Stop All Apps",
      "type": "shell",
      "command": "lsof -ti:3000,4000,5173,5174,5176,5180,8080,9099,9199 | xargs kill -9 2>/dev/null; pkill -f 'electron|Electron' 2>/dev/null; echo 'All ports and Electron cleared'",
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "shared",
        "focus": true,
        "clear": false
      }
    },

    // ==================== BUILD TASKS ====================
    {
      "label": "Build: Admin App",
      "type": "shell",
      "command": "pnpm --filter @gosenderr/admin-app build",
      "problemMatcher": ["$tsc"],
      "presentation": {
        "reveal": "always",
        "panel": "shared"
      }
    },
    {
      "label": "Build: Courier App",
      "type": "shell",
      "command": "pnpm --filter @gosenderr/courier-app build",
      "problemMatcher": ["$tsc"],
      "presentation": {
        "reveal": "always",
        "panel": "shared"
      }
    },
    {
      "label": "Build: Customer App",
      "type": "shell",
      "command": "pnpm --filter @gosenderr/marketplace-app build",
      "problemMatcher": ["$tsc"],
      "presentation": {
        "reveal": "always",
        "panel": "shared"
      }
    },
    {
      "label": "Build: Customer App",
      "type": "shell",
      "command": "pnpm --filter @gosenderr/marketplace-app build",
      "problemMatcher": ["$tsc"],
      "presentation": {
        "reveal": "always",
        "panel": "shared"
      }
    },
    {
      "label": "Build: Web App",
      "type": "shell",
      "command": "pnpm --filter @gosenderr/web build",
      "problemMatcher": ["$tsc"],
      "presentation": {
        "reveal": "always",
        "panel": "shared"
      }
    },

    // ==================== DEPLOYMENT ====================
    {
      "label": "Deploy: Firebase Hosting",
      "type": "shell",
      "command": "firebase deploy --only hosting:gosenderr-6773f --project gosenderr-6773f",
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "dedicated"
      }
    },
    {
      "label": "Deploy: Firebase Functions",
      "type": "shell",
      "command": "firebase deploy --only functions --project gosenderr-6773f",
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "dedicated"
      }
    },
    {
      "label": "Deploy: Firestore Rules",
      "type": "shell",
      "command": "firebase deploy --only firestore:rules --project gosenderr-6773f",
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "shared"
      }
    },
    {
      "label": "Deploy: Cloud Run Web",
      "type": "shell",
      "command": "bash scripts/deploy-cloudrun-web.sh",
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "dedicated"
      }
    },

    // ==================== UTILITIES ====================
    {
      "label": "Install All Dependencies",
      "type": "shell",
      "command": "pnpm install",
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "shared"
      }
    },
    {
      "label": "Lint All Projects",
      "type": "shell",
      "command": "pnpm lint",
      "problemMatcher": ["$eslint-stylish"],
      "presentation": {
        "reveal": "always",
        "panel": "shared"
      }
    },
    {
      "label": "Type Check All Projects",
      "type": "shell",
      "command": "pnpm type-check",
      "problemMatcher": ["$tsc"],
      "presentation": {
        "reveal": "always",
        "panel": "shared"
      }
    },
    {
      "label": "Clean Build Artifacts",
      "type": "shell",
      "command": "rm -rf apps/*/dist apps/*/.next apps/*/out .firebase",
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "shared"
      }
    }
  ]
}
